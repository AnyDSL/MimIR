
{-# LANGUAGE ScopedTypeVariables #-}
{-# OPTIONS_GHC -Wno-incomplete-patterns #-}
module Preopt where

import Data.IORef  
bool2bit x = if x then 1 else 0
get_0_of_2 (x, _) = x
get_1_of_2 (_, x) = x
get_0_of_3 (x, _, _) = x
get_1_of_3 (_, x, _) = x
get_2_of_3 (_, _, x) = x
magic a = magic a


__5378927_1243805 ((__5378944_1243822@(i_5378954_1243835, pb_ret_5378946_1243824)):: (Int , ([Int] -> a))) = 
        (pb_ret_5378946_1243824 (replicate 2 i_5378954_1243835))
internal_diff_core_wrap_add_5378834_1243729 (__1243777 :: Integer) = 
        let __5378884_1243750 ((__5378911_1243784@[_1243788, _1243792]):: [Int]) = 
                let _1243795 :: Int = (_1243788 + _1243792) in
                (_1243795, __5378927_1243805)
        in
        __5378884_1243750
internal_diff_core_wrap_mul_5379044_1243916 (__1243957 :: Integer) = 
        let __5379094_1243934 ((__5379122_1243965@[_1243969, _1243973]):: [Int]) = 
                let __5379138_1243986 ((__5379147_1244001@(i_5379162_1244026, pb_ret_5379149_1244003)):: (Int , ([Int] -> a))) = 
                        let _1244031 :: Int = (_1243973 * i_5379162_1244026) in
                        let _1244050 :: Int = (_1243969 * i_5379162_1244026) in
                        (pb_ret_5379149_1244003 [_1244031, _1244050])
                in
                let _1243976 :: Int = (_1243969 * _1243973) in
                (_1243976, __5379138_1243986)
        in
        __5379094_1243934
id_pb_5379243_1244212 ((_5379244_1244218@(s_5379249_1244223, _5379246_1244220)):: ([Int] , ([Int] -> a))) = 
        (_5379246_1244220 s_5379249_1244223)
extract_pb_5379240_1244197 ((_5379253_1244244@(s_5379255_1244246, _5379259_1244255)):: (Int , ([Int] -> a))) = 
        (id_pb_5379243_1244212 ([s_5379255_1244246, (0::Int)], _5379259_1244255))
zero_pb_5379336_1244549 ((_5379337_1244564@(_, _5379339_1244566)):: (Int , ([Int] -> a))) = 
        (_5379339_1244566 (replicate 2 (0::Int)))
zero_pb_5379403_1244876 ((_5379404_1244882@(_, _5379406_1244884)):: ((Int -> a) , ([Int] -> a))) = 
        (_5379406_1244884 (replicate 2 (0::Int)))
zero_pb_5379441_1245039 ((_5379442_1245055@(_, _5379444_1245057)):: (Int , ([Int] -> a))) = 
        (_5379444_1245057 (replicate 2 (0::Int)))
__5379577_1243606 ((__5379586_1243625@(_, pb_ret_5379588_1243627)):: (Int , ([Int] -> a))) = 
        (pb_ret_5379588_1243627 (replicate 2 (0::Int)))
internal_diff_core_icmp_xyglE_5379505_1243563 ((__5379561_1243585@[_1243589, _1243593]):: [Int]) = 
        let _1243596 :: Int = (bool2bit (_1243589 == _1243593)) in
        (_1243596, __5379577_1243606)
tup_pb_5379621_1245080 ((_5379622_1245087@(_, tup_ret_cont_5379624_1245089)):: (unit , ([Int] -> a))) = 
        (tup_ret_cont_5379624_1245089 (replicate 2 (0::Int)))
extract_pb_5379708_1245586 ((_5379709_1245610@(s_5379711_1245612, _5379714_1245621)):: (Int , ([Int] -> a))) = 
        (id_pb_5379243_1244212 ([(0::Int), s_5379711_1245612], _5379714_1245621))
tup_pb_5379702_1245527 ((_5379703_1245558@(((tup_s_5379705_1245560@[_5379706_1245561, _5379717_1245639]):: [Int]), tup_ret_cont_5379720_1245661)):: ([Int] , ([Int] -> a))) = 
        let inner_cont_5379707_1245571 ((_5379721_1245683@[_5379722_1245684, _5379730_1245717]):: [Int]) = 
                let inner_cont_5379718_1245649 ((_5379723_1245697@[_5379724_1245698, _5379731_1245724]):: [Int]) = 
                        let _1245703 :: Int = (_5379722_1245684 + _5379724_1245698) in
                        let _1245729 :: Int = (_5379730_1245717 + _5379731_1245724) in
                        (tup_ret_cont_5379720_1245661 [_1245703, _1245729])
                in
                (extract_pb_5379708_1245586 (tup_s_5379705_1245560 !! (1::Int), inner_cont_5379718_1245649))
        in
        (zero_pb_5379336_1244549 (tup_s_5379705_1245560 !! (0::Int), inner_cont_5379707_1245571))
zero_pb_5379756_1245809 ((_5379757_1245824@(_, _5379759_1245826)):: ((Int -> a) , ([Int] -> a))) = 
        (_5379759_1245826 (replicate 2 (0::Int)))
f_deriv_5378732_1243296 ((_5379200_1243386@(((arg_5379202_1243388@[_5379203_1244064, _5379628_1243389]):: [Int]), _5379635_1245143)):: ([Int] , ((Int , ((Int , ([Int] -> a)) -> a)) -> a))) = 
        let aug_f_5378771_1243495 ((_5378974_1243642@(((_5378976_1243644@(_5378978_1243646, _5378987_1243869)):: (Int , ((Int , ((Int , ([Int] -> a)) -> a)) -> a))), _5379350_1244632)):: ((Int , ((Int , ((Int , ([Int] -> a)) -> a)) -> a)) , (((Int , (Int -> a)) , ([Int] -> a)) -> a))) = 
                let aug_pow_cont_5378985_1243862 ((_5379204_1244077@(_5379206_1244079, _5379270_1244310)):: (Int , ((Int , ([Int] -> a)) -> a))) = 
                        let tup_pb_5379234_1244179 ((_5379262_1244285@(((tup_s_5379264_1244287@[_5379265_1244288, _5379271_1244326]):: [Int]), tup_ret_cont_5379276_1244347)):: ([Int] , ([Int] -> a))) = 
                                let inner_cont_5379268_1244298 ((_5379293_1244375@[_5379294_1244376, _5379302_1244409]):: [Int]) = 
                                        let inner_cont_5379272_1244335 ((_5379295_1244389@[_5379296_1244390, _5379303_1244416]):: [Int]) = 
                                                let _1244395 :: Int = (_5379294_1244376 + _5379296_1244390) in
                                                let _1244421 :: Int = (_5379302_1244409 + _5379303_1244416) in
                                                (tup_ret_cont_5379276_1244347 [_1244395, _1244421])
                                        in
                                        (_5379270_1244310 (tup_s_5379264_1244287 !! (1::Int), inner_cont_5379272_1244335))
                                in
                                (extract_pb_5379240_1244197 (tup_s_5379264_1244287 !! (0::Int), inner_cont_5379268_1244298))
                        in
                        let _1244081 :: (Int , ((Int , ([Int] -> a)) -> a)) = ((internal_diff_core_wrap_mul_5379044_1243916 0) [arg_5379202_1243388 !! (0::Int), _5379206_1244079]) in
                        let comp_tup_pb__5379213_1244092 ((_5379216_1244122@(_5379218_1244124, _5379317_1244439)):: (Int , ([Int] -> a))) = 
                                let comp_tup_pb__cont_5379224_1244137 (__1244431 :: [Int]) = 
                                        (tup_pb_5379234_1244179 (__1244431, _5379317_1244439))
                                in
                                ((get_1_of_2 _1244081) (_5379218_1244124, comp_tup_pb__cont_5379224_1244137))
                        in
                        ((get_1_of_2 _5378976_1243644) ((get_0_of_2 _1244081), comp_tup_pb__5379213_1244092))
                in
                let extract_pb_5379348_1244625 ((_5379351_1244651@(s_5379353_1244653, _5379357_1244667)):: (Int , ([Int] -> a))) = 
                        (_5379350_1244632 ((s_5379353_1244653, magic), _5379357_1244667))
                in
                let tup_pb_5379333_1244533 ((_5379343_1244595@(((tup_s_5379345_1244597@[_5379346_1244598, _5379360_1244685]):: [Int]), tup_ret_cont_5379363_1244707)):: ([Int] , ([Int] -> a))) = 
                        let inner_cont_5379347_1244608 ((_5379364_1244730@[_5379365_1244731, _5379373_1244764]):: [Int]) = 
                                let inner_cont_5379361_1244695 ((_5379366_1244744@[_5379367_1244745, _5379374_1244771]):: [Int]) = 
                                        let _1244750 :: Int = (_5379365_1244731 + _5379367_1244745) in
                                        let _1244776 :: Int = (_5379373_1244764 + _5379374_1244771) in
                                        (tup_ret_cont_5379363_1244707 [_1244750, _1244776])
                                in
                                (extract_pb_5379348_1244625 (tup_s_5379345_1244597 !! (1::Int), inner_cont_5379361_1244695))
                        in
                        (zero_pb_5379336_1244549 (tup_s_5379345_1244597 !! (0::Int), inner_cont_5379347_1244608))
                in
                let _1243850 :: (Int , ((Int , ([Int] -> a)) -> a)) = ((internal_diff_core_wrap_add_5378834_1243729 0) [(-1::Int), (get_0_of_2 _5378976_1243644)]) in
                let comp_tup_pb__5379326_1244473 ((_5379329_1244504@(_5379331_1244506, _5379388_1244794)):: (Int , ([Int] -> a))) = 
                        let comp_tup_pb__cont_5379332_1244516 (__1244786 :: [Int]) = 
                                (tup_pb_5379333_1244533 (__1244786, _5379388_1244794))
                        in
                        ((get_1_of_2 _1243850) (_5379331_1244506, comp_tup_pb__cont_5379332_1244516))
                in
                let tup_pb_5379325_1244456 ((_5379393_1244826@(((tup_s_5379395_1244828@(_5379397_1244830, _5379409_1244902)):: (Int , (Int -> a))), tup_ret_cont_5379412_1244924)):: ((Int , (Int -> a)) , ([Int] -> a))) = 
                        let inner_cont_5379398_1244840 ((_5379413_1244947@[_5379414_1244948, _5379422_1244981]):: [Int]) = 
                                let inner_cont_5379410_1244912 ((_5379415_1244961@[_5379416_1244962, _5379423_1244988]):: [Int]) = 
                                        let _1244967 :: Int = (_5379414_1244948 + _5379416_1244962) in
                                        let _1244993 :: Int = (_5379422_1244981 + _5379423_1244988) in
                                        (tup_ret_cont_5379412_1244924 [_1244967, _1244993])
                                in
                                (zero_pb_5379403_1244876 ((get_1_of_2 tup_s_5379395_1244828), inner_cont_5379410_1244912))
                        in
                        (comp_tup_pb__5379326_1244473 ((get_0_of_2 tup_s_5379395_1244828), inner_cont_5379398_1244840))
                in
                let aug_pow_else_5378772_1243665 _ = 
                        (aug_f_5378771_1243495 (((get_0_of_2 _1243850), aug_pow_cont_5378985_1243862), tup_pb_5379325_1244456))
                in
                let aug_pow_then_5379439_1245011 _ = 
                        ((get_1_of_2 _5378976_1243644) ((1::Int), zero_pb_5379441_1245039))
                in
                let _1243648 :: (Int , ((Int , ([Int] -> a)) -> a)) = (internal_diff_core_icmp_xyglE_5379505_1243563 [(0::Int), (get_0_of_2 _5378976_1243644)]) in
                (([aug_pow_else_5378772_1243665, aug_pow_then_5379439_1245011] !! (get_0_of_2 _1243648)) ((), tup_pb_5379621_1245080))
        in
        let aug_pow_cont_5379633_1245136 ((_5379636_1245176@(_5379638_1245178, _5379657_1245309)):: (Int , ((Int , ([Int] -> a)) -> a))) = 
                let tup_pb_5379650_1245252 ((_5379651_1245284@(((tup_s_5379653_1245286@[_5379654_1245287, _5379658_1245325]):: [Int]), tup_ret_cont_5379661_1245347)):: ([Int] , ([Int] -> a))) = 
                        let inner_cont_5379655_1245297 ((_5379662_1245370@[_5379663_1245371, _5379671_1245404]):: [Int]) = 
                                let inner_cont_5379659_1245335 ((_5379664_1245384@[_5379665_1245385, _5379672_1245411]):: [Int]) = 
                                        let _1245390 :: Int = (_5379663_1245371 + _5379665_1245385) in
                                        let _1245416 :: Int = (_5379671_1245404 + _5379672_1245411) in
                                        (tup_ret_cont_5379661_1245347 [_1245390, _1245416])
                                in
                                (_5379657_1245309 (tup_s_5379653_1245286 !! (1::Int), inner_cont_5379659_1245335))
                        in
                        (extract_pb_5379240_1244197 (tup_s_5379653_1245286 !! (0::Int), inner_cont_5379655_1245297))
                in
                        let _1245180 :: (Int , ((Int , ([Int] -> a)) -> a)) = ((internal_diff_core_wrap_mul_5379044_1243916 0) [arg_5379202_1243388 !! (0::Int), _5379638_1245178]) in
                let comp_tup_pb__5379643_1245192 ((_5379646_1245223@(_5379648_1245225, _5379686_1245434)):: (Int , ([Int] -> a))) = 
                        let comp_tup_pb__cont_5379649_1245235 (__1245426 :: [Int]) = 
                                (tup_pb_5379650_1245252 (__1245426, _5379686_1245434))
                        in
                        ((get_1_of_2 _1245180) (_5379648_1245225, comp_tup_pb__cont_5379649_1245235))
                in
                (_5379635_1245143 ((get_0_of_2 _1245180), comp_tup_pb__5379643_1245192))
        in
                let _1245124 :: (Int , ((Int , ([Int] -> a)) -> a)) = ((internal_diff_core_wrap_add_5378834_1243729 0) [(-1::Int), arg_5379202_1243388 !! (1::Int)]) in
        let comp_tup_pb__5379695_1245468 ((_5379698_1245499@(_5379700_1245501, _5379745_1245747)):: (Int , ([Int] -> a))) = 
                let comp_tup_pb__cont_5379701_1245511 (__1245739 :: [Int]) = 
                        (tup_pb_5379702_1245527 (__1245739, _5379745_1245747))
                in
                ((get_1_of_2 _1245124) (_5379700_1245501, comp_tup_pb__cont_5379701_1245511))
        in
        let tup_pb_5379694_1245451 ((_5379750_1245779@(((tup_s_5379752_1245781@(_5379754_1245783, _5379762_1245844)):: (Int , (Int -> a))), tup_ret_cont_5379765_1245866)):: ((Int , (Int -> a)) , ([Int] -> a))) = 
                let inner_cont_5379755_1245793 ((_5379766_1245889@[_5379767_1245890, _5379775_1245923]):: [Int]) = 
                        let inner_cont_5379763_1245854 ((_5379768_1245903@[_5379769_1245904, _5379776_1245930]):: [Int]) = 
                                let _1245909 :: Int = (_5379767_1245890 + _5379769_1245904) in
                                let _1245935 :: Int = (_5379775_1245923 + _5379776_1245930) in
                                (tup_ret_cont_5379765_1245866 [_1245909, _1245935])
                        in
                        (zero_pb_5379756_1245809 ((get_1_of_2 tup_s_5379752_1245781), inner_cont_5379763_1245854))
                in
                (comp_tup_pb__5379695_1245468 ((get_0_of_2 tup_s_5379752_1245781), inner_cont_5379755_1245793))
        in
        let aug_pow_else_5378747_1243412 _ = 
                (aug_f_5378771_1243495 (((get_0_of_2 _1245124), aug_pow_cont_5379633_1245136), tup_pb_5379694_1245451))
        in
        let aug_pow_then_5379790_1245953 _ = 
                (_5379635_1245143 ((1::Int), zero_pb_5379441_1245039))
        in
        let _1243394 :: Int = (bool2bit ((0::Int) == arg_5379202_1243388 !! (1::Int))) in
        (([aug_pow_else_5378747_1243412, aug_pow_then_5379790_1245953] !! _1243394) ((), tup_pb_5379621_1245080))
-- external 
f_diffed ((__5379802_1245973@(__5379804_1245975, ret_5379854_1246039)):: ([Int] , ((Int , [Int]) -> a))) = 
        let ret_cont_5379812_1245988 ((__5379824_1246008@(r_5379865_1246050, pb_5379826_1246010)):: (Int , ((Int , ([Int] -> a)) -> a))) = 
                let pb_ret_cont_5379841_1246032 (__1246051 :: [Int]) = 
                        (ret_5379854_1246039 (r_5379865_1246050, __1246051))
                in
                (pb_5379826_1246010 ((1::Int), pb_ret_cont_5379841_1246032))
        in
        (f_deriv_5378732_1243296 (__5379804_1245975, ret_cont_5379812_1245988))
-- external 
thorin_main ((__5381527_1246193@(mem_5381538_1246204, _, _, return_5381529_1246197)):: (unit , Int , (IORef (IORef Int)) , ((unit , Int) -> a))) = 
        let ret_cont_5381499_1246151 ((__5381508_1246166@(r_5381571_1246235, pb_5381510_1246168)):: (Int , ((Int , ([Int] -> a)) -> a))) = 
                let pb_ret_cont_5381518_1246186 ((__5381590_1246265@[pr_a_5381612_1246285, pr_b_5381591_1246266]):: [Int]) = 
                        let _1246242 :: Int = ((10000::Int) * r_5381571_1246235) in
                        let _1246292 :: Int = ((100::Int) * pr_a_5381612_1246285) in
                        let _1246297 :: Int = (pr_b_5381591_1246266 + _1246292) in
                        let _1246302 :: Int = (_1246242 + _1246297) in
                        (return_5381529_1246197 (mem_5381538_1246204, _1246302))
                in
                (pb_5381510_1246168 ((1::Int), pb_ret_cont_5381518_1246186))
        in
        (f_deriv_5378732_1243296 ([(42::Int), (3::Int)], ret_cont_5381499_1246151))
