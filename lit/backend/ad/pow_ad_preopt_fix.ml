
let bool2bit x = if x then 1 else 0
(* handle uninitialized values *)
(* let rec magic () : 'a = magic () *)
let unpack m = match m with
    | Some x -> x
    | None -> failwith "expected Some, got None"
let get_0_of_2 (x, _) = x (* fst *)
let get_1_of_2 (_, x) = x (* snd *)
let get_0_of_3 (x, _, _) = x
let get_1_of_3 (_, x, _) = x
let get_2_of_3 (_, _, x) = x
let rec magic arg : 'a = magic arg
[@@@warning "-partial-match"]


let rec __5378927_1236713 (((i_5378954_1236743, pb_ret_5378946_1236732) as __5378944_1236730): (int * ((int list) -> 'a))) = 
    (pb_ret_5378946_1236732 (List.init 2 (fun _ -> i_5378954_1236743)))
let rec internal_diff_core_wrap_add_5378834_1236637 (__1236685 : int) = 
    let rec __5378884_1236658 (([_1236696; _1236700] as __5378911_1236692): (int list)) = 
        let _1236703: int = (_1236696 + _1236700) in
        (_1236703, __5378927_1236713)
    in
    __5378884_1236658
let rec internal_diff_core_wrap_mul_5379044_1236824 (__1236865 : int) = 
    let rec __5379094_1236842 (([_1236877; _1236881] as __5379122_1236873): (int list)) = 
        let rec __5379138_1236894 (((i_5379162_1236934, pb_ret_5379149_1236911) as __5379147_1236909): (int * ((int list) -> 'a))) = 
            let _1236939: int = (_1236881 * i_5379162_1236934) in
            let _1236958: int = (_1236877 * i_5379162_1236934) in
            (pb_ret_5379149_1236911 [_1236939; _1236958])
        in
        let _1236884: int = (_1236877 * _1236881) in
        (_1236884, __5379138_1236894)
    in
    __5379094_1236842
let rec id_pb_5379243_1237120 (((s_5379249_1237131, _5379246_1237128) as _5379244_1237126): ((int list) * ((int list) -> 'a))) = 
    (_5379246_1237128 s_5379249_1237131)
let rec extract_pb_5379240_1237105 (((s_5379255_1237154, _5379259_1237163) as _5379253_1237152): (int * ((int list) -> 'a))) = 
    (id_pb_5379243_1237120 ([s_5379255_1237154; (0:int)], _5379259_1237163))
let rec zero_pb_5379336_1237457 (((_, _5379339_1237474) as _5379337_1237472): (int * ((int list) -> 'a))) = 
    (_5379339_1237474 (List.init 2 (fun _ -> (0:int))))
let rec zero_pb_5379403_1237784 (((_, _5379406_1237792) as _5379404_1237790): ((int -> 'a) * ((int list) -> 'a))) = 
    (_5379406_1237792 (List.init 2 (fun _ -> (0:int))))
let rec zero_pb_5379441_1237947 (((_, _5379444_1237965) as _5379442_1237963): (int * ((int list) -> 'a))) = 
    (_5379444_1237965 (List.init 2 (fun _ -> (0:int))))
let rec __5379577_1236512 (((_, pb_ret_5379588_1236533) as __5379586_1236531): (int * ((int list) -> 'a))) = 
    (pb_ret_5379588_1236533 (List.init 2 (fun _ -> (0:int))))
let rec internal_diff_core_icmp_xyglE_5379505_1236469 (([_1236495; _1236499] as __5379561_1236491): (int list)) = 
    let _1236502: int = (bool2bit (_1236495 = _1236499)) in
    (_1236502, __5379577_1236512)
let rec tup_pb_5379621_1237988 (((_, tup_ret_cont_5379624_1237997) as _5379622_1237995): (unit * ((int list) -> 'a))) = 
    (tup_ret_cont_5379624_1237997 (List.init 2 (fun _ -> (0:int))))
let rec extract_pb_5379708_1238494 (((s_5379711_1238520, _5379714_1238529) as _5379709_1238518): (int * ((int list) -> 'a))) = 
    (id_pb_5379243_1237120 ([(0:int); s_5379711_1238520], _5379714_1238529))
let rec tup_pb_5379702_1238435 ((((([_5379706_1238469; _5379717_1238547] as tup_s_5379705_1238468): (int list)), tup_ret_cont_5379720_1238569) as _5379703_1238466): ((int list) * ((int list) -> 'a))) = 
    let rec inner_cont_5379707_1238479 (([_5379722_1238592; _5379730_1238625] as _5379721_1238591): (int list)) = 
        let rec inner_cont_5379718_1238557 (([_5379724_1238606; _5379731_1238632] as _5379723_1238605): (int list)) = 
            let _1238611: int = (_5379722_1238592 + _5379724_1238606) in
            let _1238637: int = (_5379730_1238625 + _5379731_1238632) in
            (tup_ret_cont_5379720_1238569 [_1238611; _1238637])
        in
        (extract_pb_5379708_1238494 (List.nth tup_s_5379705_1238468 (1:int), inner_cont_5379718_1238557))
    in
    (zero_pb_5379336_1237457 (List.nth tup_s_5379705_1238468 (0:int), inner_cont_5379707_1238479))
let rec zero_pb_5379756_1238717 (((_, _5379759_1238734) as _5379757_1238732): ((int -> 'a) * ((int list) -> 'a))) = 
    (_5379759_1238734 (List.init 2 (fun _ -> (0:int))))
let rec f_deriv_5378732_1236202 ((((([_5379203_1236972; _5379628_1236295] as arg_5379202_1236294): (int list)), _5379635_1238051) as _5379200_1236292): ((int list) * ((int * ((int * ((int list) -> 'a)) -> 'a)) -> 'a))) = 
    let rec aug_f_5378771_1236401 ((((((_5378978_1236552, _5378987_1236777) as _5378976_1236550): (int * ((int * ((int * ((int list) -> 'a)) -> 'a)) -> 'a))), _5379350_1237540) as _5378974_1236548): ((int * ((int * ((int * ((int list) -> 'a)) -> 'a)) -> 'a)) * (((int * (int -> 'a)) * ((int list) -> 'a)) -> 'a))) = 
        let rec aug_pow_cont_5378985_1236770 (((_5379206_1236987, _5379270_1237218) as _5379204_1236985): (int * ((int * ((int list) -> 'a)) -> 'a))) = 
            let rec tup_pb_5379234_1237087 ((((([_5379265_1237196; _5379271_1237234] as tup_s_5379264_1237195): (int list)), tup_ret_cont_5379276_1237255) as _5379262_1237193): ((int list) * ((int list) -> 'a))) = 
                let rec inner_cont_5379268_1237206 (([_5379294_1237284; _5379302_1237317] as _5379293_1237283): (int list)) = 
                    let rec inner_cont_5379272_1237243 (([_5379296_1237298; _5379303_1237324] as _5379295_1237297): (int list)) = 
                        let _1237303: int = (_5379294_1237284 + _5379296_1237298) in
                        let _1237329: int = (_5379302_1237317 + _5379303_1237324) in
                        (tup_ret_cont_5379276_1237255 [_1237303; _1237329])
                    in
                    (_5379270_1237218 (List.nth tup_s_5379264_1237195 (1:int), inner_cont_5379272_1237243))
                in
                (extract_pb_5379240_1237105 (List.nth tup_s_5379264_1237195 (0:int), inner_cont_5379268_1237206))
            in
                let _1236989: (int * ((int * ((int list) -> 'a)) -> 'a)) = ((internal_diff_core_wrap_mul_5379044_1236824 0) [List.nth arg_5379202_1236294 (0:int); _5379206_1236987]) in
            let rec comp_tup_pb__5379213_1237000 (((_5379218_1237032, _5379317_1237347) as _5379216_1237030): (int * ((int list) -> 'a))) = 
                let rec comp_tup_pb__cont_5379224_1237045 (__1237339 : (int list)) = 
                    (tup_pb_5379234_1237087 (__1237339, _5379317_1237347))
                in
                (get_1_of_2 _1236989 (_5379218_1237032, comp_tup_pb__cont_5379224_1237045))
            in
            (get_1_of_2 _5378976_1236550 (get_0_of_2 _1236989, comp_tup_pb__5379213_1237000))
        in
        let rec extract_pb_5379348_1237533 (((s_5379353_1237561, _5379357_1237575) as _5379351_1237559): (int * ((int list) -> 'a))) = 
            (_5379350_1237540 ((s_5379353_1237561, magic), _5379357_1237575))
        in
        let rec tup_pb_5379333_1237441 ((((([_5379346_1237506; _5379360_1237593] as tup_s_5379345_1237505): (int list)), tup_ret_cont_5379363_1237615) as _5379343_1237503): ((int list) * ((int list) -> 'a))) = 
            let rec inner_cont_5379347_1237516 (([_5379365_1237639; _5379373_1237672] as _5379364_1237638): (int list)) = 
                let rec inner_cont_5379361_1237603 (([_5379367_1237653; _5379374_1237679] as _5379366_1237652): (int list)) = 
                    let _1237658: int = (_5379365_1237639 + _5379367_1237653) in
                    let _1237684: int = (_5379373_1237672 + _5379374_1237679) in
                    (tup_ret_cont_5379363_1237615 [_1237658; _1237684])
                in
                (extract_pb_5379348_1237533 (List.nth tup_s_5379345_1237505 (1:int), inner_cont_5379361_1237603))
            in
            (zero_pb_5379336_1237457 (List.nth tup_s_5379345_1237505 (0:int), inner_cont_5379347_1237516))
        in
            let _1236758: (int * ((int * ((int list) -> 'a)) -> 'a)) = ((internal_diff_core_wrap_add_5378834_1236637 0) [(-1:int); get_0_of_2 _5378976_1236550]) in
        let rec comp_tup_pb__5379326_1237381 (((_5379331_1237414, _5379388_1237702) as _5379329_1237412): (int * ((int list) -> 'a))) = 
            let rec comp_tup_pb__cont_5379332_1237424 (__1237694 : (int list)) = 
                (tup_pb_5379333_1237441 (__1237694, _5379388_1237702))
            in
            (get_1_of_2 _1236758 (_5379331_1237414, comp_tup_pb__cont_5379332_1237424))
        in
        let rec tup_pb_5379325_1237364 ((((((_5379397_1237738, _5379409_1237810) as tup_s_5379395_1237736): (int * (int -> 'a))), tup_ret_cont_5379412_1237832) as _5379393_1237734): ((int * (int -> 'a)) * ((int list) -> 'a))) = 
            let rec inner_cont_5379398_1237748 (([_5379414_1237856; _5379422_1237889] as _5379413_1237855): (int list)) = 
                let rec inner_cont_5379410_1237820 (([_5379416_1237870; _5379423_1237896] as _5379415_1237869): (int list)) = 
                    let _1237875: int = (_5379414_1237856 + _5379416_1237870) in
                    let _1237901: int = (_5379422_1237889 + _5379423_1237896) in
                    (tup_ret_cont_5379412_1237832 [_1237875; _1237901])
                in
                (zero_pb_5379403_1237784 (get_1_of_2 tup_s_5379395_1237736, inner_cont_5379410_1237820))
            in
            (comp_tup_pb__5379326_1237381 (get_0_of_2 tup_s_5379395_1237736, inner_cont_5379398_1237748))
        in
        let rec aug_pow_else_5378772_1236571 _ = 
            (aug_f_5378771_1236401 ((get_0_of_2 _1236758, aug_pow_cont_5378985_1236770), tup_pb_5379325_1237364))
        in
        let rec aug_pow_then_5379439_1237919 _ = 
            (get_1_of_2 _5378976_1236550 ((1:int), zero_pb_5379441_1237947))
        in
        let _1236554: (int * ((int * ((int list) -> 'a)) -> 'a)) = (internal_diff_core_icmp_xyglE_5379505_1236469 [(0:int); get_0_of_2 _5378976_1236550]) in
        (List.nth [aug_pow_else_5378772_1236571; aug_pow_then_5379439_1237919] (get_0_of_2 _1236554) ((), tup_pb_5379621_1237988))
    in
    let rec aug_pow_cont_5379633_1238044 (((_5379638_1238086, _5379657_1238217) as _5379636_1238084): (int * ((int * ((int list) -> 'a)) -> 'a))) = 
        let rec tup_pb_5379650_1238160 ((((([_5379654_1238195; _5379658_1238233] as tup_s_5379653_1238194): (int list)), tup_ret_cont_5379661_1238255) as _5379651_1238192): ((int list) * ((int list) -> 'a))) = 
            let rec inner_cont_5379655_1238205 (([_5379663_1238279; _5379671_1238312] as _5379662_1238278): (int list)) = 
                let rec inner_cont_5379659_1238243 (([_5379665_1238293; _5379672_1238319] as _5379664_1238292): (int list)) = 
                    let _1238298: int = (_5379663_1238279 + _5379665_1238293) in
                    let _1238324: int = (_5379671_1238312 + _5379672_1238319) in
                    (tup_ret_cont_5379661_1238255 [_1238298; _1238324])
                in
                (_5379657_1238217 (List.nth tup_s_5379653_1238194 (1:int), inner_cont_5379659_1238243))
            in
            (extract_pb_5379240_1237105 (List.nth tup_s_5379653_1238194 (0:int), inner_cont_5379655_1238205))
        in
            let _1238088: (int * ((int * ((int list) -> 'a)) -> 'a)) = ((internal_diff_core_wrap_mul_5379044_1236824 0) [List.nth arg_5379202_1236294 (0:int); _5379638_1238086]) in
        let rec comp_tup_pb__5379643_1238100 (((_5379648_1238133, _5379686_1238342) as _5379646_1238131): (int * ((int list) -> 'a))) = 
            let rec comp_tup_pb__cont_5379649_1238143 (__1238334 : (int list)) = 
                (tup_pb_5379650_1238160 (__1238334, _5379686_1238342))
            in
            (get_1_of_2 _1238088 (_5379648_1238133, comp_tup_pb__cont_5379649_1238143))
        in
        (_5379635_1238051 (get_0_of_2 _1238088, comp_tup_pb__5379643_1238100))
    in
        let _1238032: (int * ((int * ((int list) -> 'a)) -> 'a)) = ((internal_diff_core_wrap_add_5378834_1236637 0) [(-1:int); List.nth arg_5379202_1236294 (1:int)]) in
    let rec comp_tup_pb__5379695_1238376 (((_5379700_1238409, _5379745_1238655) as _5379698_1238407): (int * ((int list) -> 'a))) = 
        let rec comp_tup_pb__cont_5379701_1238419 (__1238647 : (int list)) = 
            (tup_pb_5379702_1238435 (__1238647, _5379745_1238655))
        in
        (get_1_of_2 _1238032 (_5379700_1238409, comp_tup_pb__cont_5379701_1238419))
    in
    let rec tup_pb_5379694_1238359 ((((((_5379754_1238691, _5379762_1238752) as tup_s_5379752_1238689): (int * (int -> 'a))), tup_ret_cont_5379765_1238774) as _5379750_1238687): ((int * (int -> 'a)) * ((int list) -> 'a))) = 
        let rec inner_cont_5379755_1238701 (([_5379767_1238798; _5379775_1238831] as _5379766_1238797): (int list)) = 
            let rec inner_cont_5379763_1238762 (([_5379769_1238812; _5379776_1238838] as _5379768_1238811): (int list)) = 
                let _1238817: int = (_5379767_1238798 + _5379769_1238812) in
                let _1238843: int = (_5379775_1238831 + _5379776_1238838) in
                (tup_ret_cont_5379765_1238774 [_1238817; _1238843])
            in
            (zero_pb_5379756_1238717 (get_1_of_2 tup_s_5379752_1238689, inner_cont_5379763_1238762))
        in
        (comp_tup_pb__5379695_1238376 (get_0_of_2 tup_s_5379752_1238689, inner_cont_5379755_1238701))
    in
    let rec aug_pow_else_5378747_1236318 _ = 
        (aug_f_5378771_1236401 ((get_0_of_2 _1238032, aug_pow_cont_5379633_1238044), tup_pb_5379694_1238359))
    in
    let rec aug_pow_then_5379790_1238861 _ = 
        (_5379635_1238051 ((1:int), zero_pb_5379441_1237947))
    in
    let _1236300: int = (bool2bit ((0:int) = List.nth arg_5379202_1236294 (1:int))) in
    (List.nth [aug_pow_else_5378747_1236318; aug_pow_then_5379790_1238861] _1236300 ((), tup_pb_5379621_1237988))
(* external *)
let rec f_diffed (((__5379804_1238883, ret_5379854_1238947) as __5379802_1238881): ((int list) * ((int * (int list)) -> 'a))) = 
    let rec ret_cont_5379812_1238896 (((r_5379865_1238958, pb_5379826_1238918) as __5379824_1238916): (int * ((int * ((int list) -> 'a)) -> 'a))) = 
        let rec pb_ret_cont_5379841_1238940 (__1238959 : (int list)) = 
            (ret_5379854_1238947 (r_5379865_1238958, __1238959))
        in
        (pb_5379826_1238918 ((1:int), pb_ret_cont_5379841_1238940))
    in
    (f_deriv_5378732_1236202 (__5379804_1238883, ret_cont_5379812_1238896))
(* external *)
let rec thorin_main (((mem_5381538_1239112, _, _, return_5381529_1239105) as __5381527_1239101): (unit * int * ((int option ref) option ref) * ((unit * int) -> 'a))) = 
    let rec ret_cont_5381499_1239059 (((r_5381571_1239143, pb_5381510_1239076) as __5381508_1239074): (int * ((int * ((int list) -> 'a)) -> 'a))) = 
        let rec pb_ret_cont_5381518_1239094 (([pr_a_5381612_1239193; pr_b_5381591_1239174] as __5381590_1239173): (int list)) = 
            let _1239150: int = ((10000:int) * r_5381571_1239143) in
            let _1239200: int = ((100:int) * pr_a_5381612_1239193) in
            let _1239205: int = (pr_b_5381591_1239174 + _1239200) in
            let _1239210: int = (_1239150 + _1239205) in
            (return_5381529_1239105 (mem_5381538_1239112, _1239210))
        in
        (pb_5381510_1239076 ((1:int), pb_ret_cont_5381518_1239094))
    in
    (f_deriv_5378732_1236202 ([(42:int); (3:int)], ret_cont_5381499_1239059))
