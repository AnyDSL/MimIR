extern all_on_gpu([float], fn(fn() -> int, fn() -> int, fn() -> int) -> void) -> int;
extern array(int) -> [float];

fn main() -> [float] {
    let width   = 1024;
    let arr     = array(width);
    let out     = array(width);

    all_on_gpu(out, |x : fn() -> int, y : fn() -> int, z : fn() -> int| -> void {
        out[x()] = arr[x()];
    });

    return out;
}
