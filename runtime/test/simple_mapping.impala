extern nvvm(int, fn() -> void) -> void;

fn run_on_gpu(size : int, body : fn(int) -> void) -> void {
    nvvm(size, || -> void {
        let index = nvvm_read_ptx_sreg_tid_x() + nvvm_read_ptx_sreg_ntid_x() * nvvm_read_ptx_sreg_ctaid_x();
        body(index);
    });
}
