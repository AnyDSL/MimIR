SET ( LIBRARY_NAME thorin )

# get source files
FILE ( GLOB_RECURSE SOURCES *.cpp *.h )

# create lib
get_thorin_dependency_libs( THORIN_LIBS )

# set define for *.s files
GET_FILENAME_COMPONENT ( THORIN_RUNTIME_PLATFORMS "${CMAKE_CURRENT_SOURCE_DIR}/../../runtime/platforms" ABSOLUTE )
FILE ( GLOB RUNTIME_SOURCES ${CMAKE_CURRENT_SOURCE_DIR}/be/llvm/runtimes/*.cpp )
SET_SOURCE_FILES_PROPERTIES(${RUNTIME_SOURCES} PROPERTIES COMPILE_DEFINITIONS THORIN_RUNTIME_PLATFORMS=\"${THORIN_RUNTIME_PLATFORMS}/\")

IF ( BUILD_STATIC )
    MESSAGE ( "Building thorin as static library ..." )
    ADD_LIBRARY ( ${LIBRARY_NAME} STATIC ${SOURCES} )
ELSE ()
    MESSAGE ( "Building thorin as shared library ..." )
    ADD_LIBRARY ( ${LIBRARY_NAME} SHARED ${SOURCES} )
ENDIF ()

TARGET_LINK_LIBRARIES ( ${LIBRARY_NAME} ${THORIN_LIBS} )
