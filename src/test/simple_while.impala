def simple_while(i : int,
                head : pi(int, pi(float, bool)), 
                body : pi(float, pi(int)), 
                next : pi(float)) 
{
    head(i, 
        lambda(f : float, cond : bool) {
            if (cond)
                simple_while(body(f), head, body, next);
            else
                next(f);
        }
    );
}

def generic_while[[L, B]](l : L,
                          head : pi(L, pi(B, bool)), 
                          body : pi(B, pi(L)), 
                          next : pi(B)) 
{
    head(l,
        lambda(b : B, cond : bool) {
            if (cond)
                generic_while(body(b), head, body, next);
            else
                next(b);
        }
    );
}
